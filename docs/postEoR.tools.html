<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Python: module postEoR.tools</title>
</head><body>

<table class="heading">
<tr class="heading-text decor">
<td class="title">&nbsp;<br><strong class="title"><a href="postEoR.html" class="white">postEoR</a>.tools</strong></td>
<td class="extra"><a href=".">index</a><br><a href="file:/Users/Rach/opt/anaconda3/envs/fast/lib/python3.11/site-packages/postEoR/tools.py">/Users/Rach/opt/anaconda3/envs/fast/lib/python3.11/site-packages/postEoR/tools.py</a></td></tr></table>
    <p><span class="code">Functions&nbsp;to&nbsp;be&nbsp;used&nbsp;within&nbsp;generating&nbsp;the&nbsp;coeval&nbsp;boxes&nbsp;and&nbsp;lightcones.</span></p>
<p>
<table class="section">
<tr class="decor pkg-content-decor heading-text">
<td class="section-title" colspan=3>&nbsp;<br><strong class="bigsection">Modules</strong></td></tr>
    
<tr><td class="decor pkg-content-decor"><span class="code">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></td><td>&nbsp;</td>
<td class="singlecolumn"><table><tr><td class="multicolumn"><a href="scipy.ndimage.html">scipy.ndimage</a><br>
</td><td class="multicolumn"><a href="numpy.html">numpy</a><br>
</td><td class="multicolumn"><a href="py21cmfast.html">py21cmfast</a><br>
</td><td class="multicolumn"></td></tr></table></td></tr></table><p>
<table class="section">
<tr class="decor functions-decor heading-text">
<td class="section-title" colspan=3>&nbsp;<br><strong class="bigsection">Functions</strong></td></tr>
    
<tr><td class="decor functions-decor"><span class="code">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></td><td>&nbsp;</td>
<td class="singlecolumn"><dl><dt><a name="-bin_halos"><strong>bin_halos</strong></a>(halo_field, no_bins=25)</dt><dd><span class="code">Collects&nbsp;the&nbsp;halos&nbsp;within&nbsp;an&nbsp;input&nbsp;halo&nbsp;field&nbsp;into&nbsp;equally&nbsp;spaced&nbsp;mass&nbsp;bins.<br>
&nbsp;<br>
Parameters<br>
----------<br>
halo_field&nbsp;:&nbsp;NDarray<br>
&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;distribution&nbsp;of&nbsp;halo&nbsp;masses&nbsp;across&nbsp;the&nbsp;field,&nbsp;in&nbsp;solar&nbsp;masses/h.<br>
no_bins&nbsp;:&nbsp;int&nbsp;(optional)<br>
&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;number&nbsp;of&nbsp;mass&nbsp;bins&nbsp;into&nbsp;which&nbsp;the&nbsp;halos&nbsp;are&nbsp;collected.&nbsp;Defaults&nbsp;to&nbsp;25.<br>
&nbsp;<br>
Returns<br>
-------<br>
binned_halo_field&nbsp;:&nbsp;NDarray<br>
&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;halo&nbsp;field,&nbsp;arranged&nbsp;into&nbsp;mass&nbsp;bins,&nbsp;in&nbsp;solar&nbsp;masses/h.<br>
bins&nbsp;:&nbsp;NDarray<br>
&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;bin&nbsp;edges&nbsp;that&nbsp;define&nbsp;the&nbsp;mass&nbsp;bins,&nbsp;in&nbsp;solar&nbsp;masses/h.</span></dd></dl>
 <dl><dt><a name="-create_spherical_profile"><strong>create_spherical_profile</strong></a>(halo, z, box_len, HII_dim, max_rad=1)</dt><dd><span class="code">Calculates&nbsp;the&nbsp;radial&nbsp;distribution&nbsp;of&nbsp;HI&nbsp;surrounding&nbsp;a&nbsp;halo&nbsp;of&nbsp;given&nbsp;mass.<br>
&nbsp;<br>
Parameters<br>
----------<br>
halo&nbsp;:&nbsp;float<br>
&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;mass&nbsp;of&nbsp;the&nbsp;halo&nbsp;whose&nbsp;HI&nbsp;profile&nbsp;is&nbsp;being&nbsp;calculated.<br>
z&nbsp;:&nbsp;float<br>
&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;redshift&nbsp;at&nbsp;which&nbsp;the&nbsp;profile&nbsp;is&nbsp;being&nbsp;calculated.<br>
box_len&nbsp;:&nbsp;float<br>
&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;size&nbsp;in&nbsp;Mpc/h&nbsp;of&nbsp;the&nbsp;full&nbsp;box/spatial&nbsp;dimensions&nbsp;of&nbsp;cone.<br>
HII_dim:&nbsp;int<br>
&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;number&nbsp;of&nbsp;cells&nbsp;in&nbsp;each&nbsp;dimension&nbsp;of&nbsp;the&nbsp;full&nbsp;box/spatial&nbsp;dimensions&nbsp;of&nbsp;cone.<br>
max_rad:&nbsp;float&nbsp;(optional)<br>
&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;maximum&nbsp;radius&nbsp;out&nbsp;to&nbsp;which&nbsp;the&nbsp;profile&nbsp;will&nbsp;be&nbsp;evaluated.&nbsp;Defaults&nbsp;to&nbsp;1&nbsp;Mpc/h.<br>
&nbsp;<br>
Returns<br>
-------<br>
sph_prof_fin&nbsp;:&nbsp;NDarray<br>
&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;HI&nbsp;distribution&nbsp;around&nbsp;the&nbsp;input&nbsp;halo.</span></dd></dl>
 <dl><dt><a name="-find_halos_watershed"><strong>find_halos_watershed</strong></a>(dens, box_len, HII_dim, overdens_cap=0.0, connectivity=3, compactness=0, normalise=True, smooth=False, sigma=1)</dt><dd><span class="code">Returns&nbsp;mass&nbsp;and&nbsp;centre&nbsp;position&nbsp;of&nbsp;halos&nbsp;in&nbsp;solar&nbsp;masses.&nbsp;<br>
Stops&nbsp;at&nbsp;either&nbsp;no&nbsp;change&nbsp;after&nbsp;algorithm&nbsp;applied,&nbsp;or&nbsp;when&nbsp;maximum&nbsp;number&nbsp;of&nbsp;iterations&nbsp;has&nbsp;been&nbsp;reached.<br>
&nbsp;<br>
Parameters<br>
----------<br>
overdensity_field&nbsp;:&nbsp;NDarray<br>
&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;overdensity&nbsp;field&nbsp;on&nbsp;which&nbsp;the&nbsp;halos&nbsp;are&nbsp;to&nbsp;be&nbsp;found.<br>
box_len&nbsp;:&nbsp;float<br>
&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;physical&nbsp;length&nbsp;of&nbsp;each&nbsp;of&nbsp;the&nbsp;spatial&nbsp;dimensions&nbsp;of&nbsp;the&nbsp;box&nbsp;/&nbsp;cone,&nbsp;in&nbsp;Mpc/h.&nbsp;<br>
HII_dim&nbsp;:&nbsp;int<br>
&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;number&nbsp;of&nbsp;cells&nbsp;in&nbsp;each&nbsp;of&nbsp;the&nbsp;spatial&nbsp;dimensions&nbsp;of&nbsp;the&nbsp;box&nbsp;/&nbsp;cone.<br>
overdens_cap&nbsp;:&nbsp;float&nbsp;(optional)<br>
&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;minimum&nbsp;overdensity&nbsp;for&nbsp;which&nbsp;a&nbsp;cell&nbsp;is&nbsp;considered&nbsp;to&nbsp;be&nbsp;associated&nbsp;with&nbsp;a&nbsp;halo.&nbsp;Defaults&nbsp;to&nbsp;0.<br>
connectivity&nbsp;:&nbsp;float&nbsp;(optional)<br>
&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;neighbour&nbsp;connectivity&nbsp;parameter&nbsp;used&nbsp;in&nbsp;the&nbsp;watershed&nbsp;algorithm.&nbsp;Defaults&nbsp;to&nbsp;3&nbsp;(maximum&nbsp;-&nbsp;going&nbsp;beyond&nbsp;this&nbsp;doesn't&nbsp;change&nbsp;the&nbsp;halos).<br>
compactness&nbsp;:&nbsp;float&nbsp;(optional)<br>
&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;object&nbsp;compactness&nbsp;parameter&nbsp;used&nbsp;in&nbsp;the&nbsp;watershed&nbsp;algorithm.&nbsp;Defaults&nbsp;to&nbsp;1.<br>
&nbsp;<br>
Returns&nbsp;<br>
-------<br>
halo_field&nbsp;:&nbsp;NDarray<br>
&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;distribution&nbsp;of&nbsp;halo&nbsp;masses&nbsp;across&nbsp;the&nbsp;field,&nbsp;in&nbsp;solar&nbsp;masses/h.</span></dd></dl>
 <dl><dt><a name="-get_HI_field"><strong>get_HI_field</strong></a>(halo_field, z, box_len, HII_dim, no_bins=25, max_rad=1)</dt><dd><span class="code">Convolves&nbsp;the&nbsp;HI&nbsp;profiles&nbsp;with&nbsp;the&nbsp;halo&nbsp;locations&nbsp;to&nbsp;produce&nbsp;the&nbsp;complete&nbsp;final&nbsp;HI&nbsp;mass&nbsp;field.<br>
&nbsp;<br>
Parameters<br>
----------<br>
halo_field&nbsp;:&nbsp;NDarray<br>
&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;distribution&nbsp;of&nbsp;halo&nbsp;masses&nbsp;across&nbsp;the&nbsp;field,&nbsp;in&nbsp;solar&nbsp;masses/h.<br>
z&nbsp;:&nbsp;float<br>
&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;redshift&nbsp;at&nbsp;which&nbsp;the&nbsp;field&nbsp;is&nbsp;evaluated.<br>
box_len&nbsp;:&nbsp;float<br>
&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;physical&nbsp;length&nbsp;of&nbsp;each&nbsp;of&nbsp;the&nbsp;spatial&nbsp;dimensions&nbsp;of&nbsp;the&nbsp;box&nbsp;/&nbsp;cone,&nbsp;in&nbsp;Mpc/h.<br>
HII_dim:&nbsp;int<br>
&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;number&nbsp;of&nbsp;cells&nbsp;in&nbsp;each&nbsp;of&nbsp;the&nbsp;spatial&nbsp;dimensions&nbsp;of&nbsp;the&nbsp;box&nbsp;/&nbsp;cone.<br>
no_bins:&nbsp;int&nbsp;(optional)<br>
&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;number&nbsp;of&nbsp;mass&nbsp;bins&nbsp;into&nbsp;which&nbsp;the&nbsp;halos&nbsp;are&nbsp;collected.&nbsp;Defaults&nbsp;to&nbsp;25.<br>
max_rad:&nbsp;float&nbsp;(optional)<br>
&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;maximum&nbsp;radius&nbsp;out&nbsp;to&nbsp;which&nbsp;the&nbsp;spherical&nbsp;HI&nbsp;profile&nbsp;is&nbsp;evaluated,&nbsp;in&nbsp;Mpc/h.&nbsp;Defaults&nbsp;to&nbsp;1&nbsp;Mpc/h.<br>
&nbsp;<br>
Returns<br>
-------<br>
final_HI_field&nbsp;:&nbsp;NDarray<br>
&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;distribution&nbsp;of&nbsp;HI&nbsp;mass&nbsp;across&nbsp;the&nbsp;field,&nbsp;in&nbsp;solar&nbsp;masses/h.</span></dd></dl>
 <dl><dt><a name="-get_conc"><strong>get_conc</strong></a>(M, z)</dt><dd><span class="code">Calculates&nbsp;the&nbsp;halo&nbsp;concentration&nbsp;(dimensionless)&nbsp;of&nbsp;a&nbsp;halo&nbsp;of&nbsp;mass&nbsp;M,&nbsp;at&nbsp;redshift&nbsp;z.<br>
&nbsp;<br>
Parameters<br>
----------<br>
M&nbsp;:&nbsp;float<br>
&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;mass&nbsp;of&nbsp;the&nbsp;object,&nbsp;in&nbsp;solar&nbsp;masses/h.<br>
z&nbsp;:&nbsp;float<br>
&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;redshift&nbsp;at&nbsp;which&nbsp;to&nbsp;evaluate&nbsp;the&nbsp;halo&nbsp;concentration.<br>
&nbsp;<br>
Returns<br>
-------<br>
conc&nbsp;:&nbsp;float<br>
&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;halo&nbsp;concentration&nbsp;of&nbsp;the&nbsp;halo&nbsp;(dimensionless).</span></dd></dl>
 <dl><dt><a name="-get_delta_vir"><strong>get_delta_vir</strong></a>(z)</dt><dd><span class="code">Calculates&nbsp;the&nbsp;mean&nbsp;halo&nbsp;overdensity&nbsp;within&nbsp;the&nbsp;virial&nbsp;radius&nbsp;at&nbsp;a&nbsp;given&nbsp;redshift.<br>
&nbsp;<br>
Parameters<br>
----------<br>
z&nbsp;:&nbsp;float<br>
&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;redshift&nbsp;at&nbsp;which&nbsp;the&nbsp;mean&nbsp;overdensity&nbsp;will&nbsp;be&nbsp;calculated.<br>
&nbsp;<br>
Returns<br>
-------<br>
delta_vir&nbsp;:&nbsp;float<br>
&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;mean&nbsp;halo&nbsp;overdensity&nbsp;within&nbsp;the&nbsp;virial&nbsp;radius&nbsp;at&nbsp;the&nbsp;input&nbsp;redshift.&nbsp;Dimensionless.</span></dd></dl>
 <dl><dt><a name="-get_r_vir"><strong>get_r_vir</strong></a>(M, z)</dt><dd><span class="code">Calculates&nbsp;the&nbsp;virial&nbsp;radius&nbsp;of&nbsp;an&nbsp;input&nbsp;object&nbsp;of&nbsp;mass&nbsp;M&nbsp;at&nbsp;redshift&nbsp;z.<br>
&nbsp;<br>
Parameters<br>
----------<br>
M&nbsp;:&nbsp;float<br>
&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;mass&nbsp;of&nbsp;the&nbsp;object,&nbsp;in&nbsp;solar&nbsp;masses/h.<br>
z&nbsp;:&nbsp;float<br>
&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;redshift&nbsp;at&nbsp;which&nbsp;to&nbsp;evaluate&nbsp;the&nbsp;virial&nbsp;radius.<br>
&nbsp;<br>
Returns<br>
-------<br>
r&nbsp;:&nbsp;float<br>
&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;virial&nbsp;radius&nbsp;of&nbsp;the&nbsp;object,&nbsp;in&nbsp;Mpc/h.</span></dd></dl>
 <dl><dt><a name="-get_rho_0"><strong>get_rho_0</strong></a>(M, z)</dt><dd><span class="code">Calculates&nbsp;the&nbsp;rho_0&nbsp;constant&nbsp;for&nbsp;a&nbsp;given&nbsp;modified&nbsp;NFW&nbsp;profile.<br>
&nbsp;<br>
Parameters<br>
----------<br>
M&nbsp;:&nbsp;float<br>
&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;mass&nbsp;of&nbsp;the&nbsp;halo,&nbsp;in&nbsp;solar&nbsp;masses.<br>
z&nbsp;:&nbsp;float<br>
&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;redshift&nbsp;at&nbsp;which&nbsp;to&nbsp;evaluate&nbsp;rho_0&nbsp;at.<br>
&nbsp;<br>
Returns<br>
-------<br>
rho&nbsp;:&nbsp;float<br>
&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;rho_0&nbsp;constant&nbsp;for&nbsp;the&nbsp;input&nbsp;halo,&nbsp;in&nbsp;solar&nbsp;masses&nbsp;*&nbsp;hlittle^2&nbsp;/&nbsp;Mpc^3.</span></dd></dl>
 <dl><dt><a name="-get_vc"><strong>get_vc</strong></a>(M, z)</dt><dd><span class="code">Calculates&nbsp;the&nbsp;virial&nbsp;velocity&nbsp;of&nbsp;an&nbsp;input&nbsp;object&nbsp;of&nbsp;mass&nbsp;M&nbsp;at&nbsp;redshift&nbsp;z.<br>
&nbsp;<br>
Parameters<br>
----------<br>
M&nbsp;:&nbsp;float<br>
&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;mass&nbsp;of&nbsp;the&nbsp;object,&nbsp;in&nbsp;solar&nbsp;masses.<br>
z&nbsp;:&nbsp;float<br>
&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;redshift&nbsp;at&nbsp;which&nbsp;to&nbsp;evaluate&nbsp;the&nbsp;virial&nbsp;velocity.<br>
&nbsp;<br>
Returns<br>
-------<br>
vc&nbsp;:&nbsp;float<br>
&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;virial&nbsp;velocity&nbsp;of&nbsp;the&nbsp;object,&nbsp;in&nbsp;km/s.</span></dd></dl>
 <dl><dt><a name="-hi_from_halos_2"><strong>hi_from_halos_2</strong></a>(halo_field, z)</dt><dd><span class="code">HI&nbsp;mass-halo&nbsp;mass&nbsp;relation&nbsp;from&nbsp;Padmanabhan&nbsp;and&nbsp;Refregier&nbsp;(2017).<br>
&nbsp;<br>
Parameters<br>
----------<br>
halo_field&nbsp;:&nbsp;NDarray<br>
&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;distribution&nbsp;of&nbsp;halo&nbsp;masses&nbsp;across&nbsp;the&nbsp;field,&nbsp;in&nbsp;solar&nbsp;masses/h&nbsp;.<br>
z&nbsp;:&nbsp;float<br>
&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;redshift&nbsp;at&nbsp;which&nbsp;to&nbsp;evaluate&nbsp;the&nbsp;quantity.<br>
&nbsp;<br>
Returns<br>
-------<br>
xHI_mass&nbsp;:&nbsp;NDarray<br>
&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;total&nbsp;neutral&nbsp;hydrogen&nbsp;mass&nbsp;associated&nbsp;with&nbsp;each&nbsp;of&nbsp;the&nbsp;halos&nbsp;in&nbsp;the&nbsp;field,&nbsp;in&nbsp;solar&nbsp;masses/h.</span></dd></dl>
 <dl><dt><a name="-obtain_HI_at_dist"><strong>obtain_HI_at_dist</strong></a>(M, z, r_end, r_start)</dt><dd><span class="code">Calculates&nbsp;the&nbsp;total&nbsp;HI&nbsp;mass&nbsp;over&nbsp;a&nbsp;given&nbsp;radius&nbsp;range&nbsp;from&nbsp;a&nbsp;halo&nbsp;of&nbsp;mass&nbsp;M,&nbsp;in&nbsp;solar&nbsp;masses/h.<br>
&nbsp;<br>
Parameters<br>
----------<br>
M&nbsp;:&nbsp;float<br>
&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;mass&nbsp;of&nbsp;the&nbsp;central&nbsp;halo,&nbsp;in&nbsp;solar&nbsp;masses/h.<br>
z&nbsp;:&nbsp;float<br>
&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;redshift&nbsp;at&nbsp;which&nbsp;to&nbsp;evaluate&nbsp;the&nbsp;HI&nbsp;mass&nbsp;at.<br>
r_end&nbsp;:&nbsp;float<br>
&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;maximum&nbsp;radius&nbsp;of&nbsp;the&nbsp;shell&nbsp;in&nbsp;consideration,&nbsp;in&nbsp;Mpc/h.<br>
r_start&nbsp;:&nbsp;float<br>
&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;minimum&nbsp;radius&nbsp;of&nbsp;the&nbsp;shell&nbsp;in&nbsp;consideration,&nbsp;in&nbsp;Mpc/h.<br>
&nbsp;<br>
Returns<br>
-------<br>
shell_mass&nbsp;:&nbsp;float<br>
&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;total&nbsp;HI&nbsp;mass&nbsp;contained&nbsp;within&nbsp;the&nbsp;shell,&nbsp;in&nbsp;solar&nbsp;masses/h.</span></dd></dl>
</td></tr></table><p>
<table class="section">
<tr class="decor data-decor heading-text">
<td class="section-title" colspan=3>&nbsp;<br><strong class="bigsection">Data</strong></td></tr>
    
<tr><td class="decor data-decor"><span class="code">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></td><td>&nbsp;</td>
<td class="singlecolumn"><strong>A_10</strong> = 2.86888e-15<br>
<strong>G</strong> = 6.6743e-11<br>
<strong>Mpc_to_m</strong> = 3.0857e+22<br>
<strong>OMb</strong> = 0.04897468161869667<br>
<strong>OMl</strong> = 0.6903585584544936<br>
<strong>OMm</strong> = 0.30964144154550644<br>
<strong>T_CMB</strong> = 2.7255<br>
<strong>c</strong> = 299792458<br>
<strong>cosmo_params</strong> = CosmoParams(OMb:0.04897, OMm:0.3096, POWER_INDEX:0.9665, SIGMA_8:0.8102, hlittle:0.6766)<br>
<strong>h</strong> = 6.63e-34<br>
<strong>hlittle</strong> = 0.6766<br>
<strong>hydrogen_baryon_frac</strong> = 0.75<br>
<strong>k_B</strong> = 1.380649e-23<br>
<strong>m_H</strong> = 1.6735e-27<br>
<strong>nu_21</strong> = 1420405751.7680001<br>
<strong>solar_mass</strong> = 1.9890000000000002e+30</td></tr></table>
</body></html>